plugins {
  alias(libs.plugins.android.application)
  alias(libs.plugins.kotlin.android)
  id 'com.google.dagger.hilt.android'
  id 'kotlin-android'
  id 'kotlin-parcelize'
//  id 'com.google.devtools.ksp'
  id 'kotlin-kapt'
}

android {
  namespace 'me.spica27.spicamusic'
  compileSdk 34

  defaultConfig {
    applicationId "me.spica27.spicamusic"
    minSdk 24
    targetSdk 33
    versionCode 1
    versionName "1.0"

    testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
    vectorDrawables {
      useSupportLibrary true
    }
  }

  signingConfigs {
    signingConfig {
      storeFile rootProject.file("key.jks")
      storePassword 'SPICa27'
      keyAlias 'wuqi'
      keyPassword 'SPICa27'
    }
  }

  lintOptions {
    checkReleaseBuilds false
    abortOnError false
  }


  buildTypes {
    release {
      minifyEnabled false
      proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
      signingConfig signingConfigs.signingConfig
    }
    debug{
      signingConfig signingConfigs.signingConfig
    }
  }
  compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_8
    targetCompatibility JavaVersion.VERSION_1_8
  }
  kotlinOptions {
    jvmTarget = '1.8'
  }
  buildFeatures {
    compose true
  }
  composeOptions {
    kotlinCompilerExtensionVersion '1.5.7'
  }
//  kapt {
//    correctErrorTypes = true
//  }
  packaging {
    resources {
      excludes += '/META-INF/{AL2.0,LGPL2.1}'
    }
  }
}

dependencies {
  implementation fileTree(dir: "libs", include: ["*.jar"])
  //  implementation project(":extension-flac2120")
  implementation libs.androidx.core.ktx
  implementation libs.androidx.lifecycle.runtime.ktx
  implementation libs.androidx.activity.compose
  implementation platform(libs.androidx.compose.bom)
  implementation libs.androidx.ui
  implementation libs.androidx.ui.graphics
  implementation libs.androidx.ui.tooling.preview
  implementation libs.androidx.material3
  testImplementation libs.junit
  androidTestImplementation libs.androidx.junit
  androidTestImplementation libs.androidx.espresso.core
  androidTestImplementation platform(libs.androidx.compose.bom)
  androidTestImplementation libs.androidx.ui.test.junit4
  debugImplementation libs.androidx.ui.tooling
  debugImplementation libs.androidx.ui.test.manifest
  implementation("io.coil-kt:coil-compose:2.4.0")
  implementation("androidx.lifecycle:lifecycle-viewmodel-compose:2.8.6")

  //  implementation 'com.github.EspoirX:StarrySky:v2.6.9'

  def room_version = "2.6.1"
  implementation("androidx.room:room-runtime:$room_version")
  kapt("androidx.room:room-compiler:$room_version")
  implementation("androidx.room:room-ktx:$room_version")

  /** hilt **/
  implementation "com.google.dagger:hilt-android:2.52"
  kapt "com.google.dagger:hilt-compiler:2.52"
  implementation 'androidx.hilt:hilt-navigation-compose:1.2.0'

  implementation 'com.jakewharton.timber:timber:5.0.1'
  implementation 'com.github.paramsen:noise:2.0.0'

  def accompanistVersion = "0.36.0"
  implementation("com.google.accompanist:accompanist-permissions:$accompanistVersion")

  // 播放器
  implementation("com.google.android.exoplayer:exoplayer-core:2.19.1")
  //    implementation 'com.google.android.exoplayer:exoplayer-core:2.X.X'
  implementation "androidx.media:media:1.7.0"
}